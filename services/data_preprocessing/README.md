Again, some fancy data preprocessing...
